# 6장. Planning(계획) 패턴

## 6.1 계획 패턴 개요

- **정의**: 복잡한 목표를 **자율적으로 실행 가능한 단계·순서로 분해**하고, 실행 중에 **적응·재계획**하는 패턴이다.
- 단순 작업(고정 워크플로) vs 복잡 작업(미지의 방법 필요):  
  - 고정 → 체이닝·라우팅 등으로 충분.  
  - 복잡 → Planning으로 “어떻게 할지” 스스로 설계.
- 비유: “외부 팀 구성” 지시 → 기획자가 예산·일정·참가자 고려해 계획 수립·조정.

### 핵심 특징

- **동적 생성**: 미리 정해진 스크립트가 아니라, 목표·상태에 따라 **실시간 계획 생성**.
- **적응성**: 장애·새 정보 발생 시 계획 재평가·수정.
- **유연성 vs 예측 가능성 트레이드오프**:  
  - 자율성 ↑ → 불확실성 ↑, 그래서 **고정 워크플로가 더 나을 수 있는 경우**도 명확히 구분.

---

## 6.2 계획 패턴의 역할

- **초기 상태 → 목표 상태 이동**: 현재 상황 파악 → 최적 경로(단계 순서) 수립.
- **전략 수립**: 종속성 고려한 논리적 순서, 자원 배분, 리스크 완화.
- **실행 + 모니터링**: 계획 실행 중 진행 상황 추적, 필요 시 재계획.

---

## 6.3 실제 사용 사례

### 6.3.1 절차적 작업 자동화

- 예: 신입 직원 온보딩.
- 계획 단계:  
  - 시스템 계정 생성  
  - 교육 모듈 배정  
  - 부서 간 협력 조율  
- 효과: 종속성(계정 생성 후 교육 시작 등) 자동 관리.

### 6.3.2 로봇공학·자율 시스템

- 예: 자율 주행, 로봇 경로 계획.
- 계획: 초기 위치 → 목표 위치, 장애물 회피·최적화(시간·에너지).

### 6.3.3 구조화된 정보 합성

- 예: 연구 보고서 생성.
- 계획: 정보 수집 → 요약 → 구조화 → 개선 반복.

### 6.3.4 고객 지원·문제 해결

- 예: 다단계 문제 해결.
- 계획: 진단 → 솔루션 구현 → 에스컬레이션 여부 판단.

---

## 6.4 고급 계획 에이전트 예시

### 6.4.1 Google Gemini DeepResearch

- **기능**: 복잡 주제에 대해 **반복적·자율적 연구** 수행.
- 흐름:  
  1. 사용자 프롬프트 → 다점 연구 계획 생성 → 사용자 승인.  
  2. 계획 실행: Google Search 동적 쿼리 → 결과 분석 → 지식 격차 파악 → 후속 검색.  
  3. 종합: 다페이지 보고서(인용 포함), 대화형(오디오·차트).
- 강점: 수백 출처 분석, 비동기·복원력 있는 실행, 사용자 중단·재개 가능.

### 6.4.2 OpenAI Deep Research API

- **모델**: o3-deep-research 등 전문 모델.
- 흐름: 고수준 질의 → 하위 질문 분해 → 웹 검색·코드 실행 → 인용 풍부 보고서.
- 특징:  
  - 인라인 인용(메타데이터 포함).  
  - 중간 단계 투명성(추론·검색 쿼리·코드 공개).  
  - MCP(Model Context Protocol)로 내부 데이터 통합.

---

## 6.5 구현 관점: CrewAI 예시

- **Planner Agent**:  
  - 역할: “기사 기획자 및 작가”.  
  - 목표: 주제에 대한 **요점별 계획 작성 → 요약 작성**.  
- **Task**:  
  - 설명: 1) 계획 작성, 2) 계획 따라 200자 요약.  
  - 예상 출력: `### 계획` + `### 요약` 형식.
- **Crew**: 에이전트·작업을 순차 프로세스로 묶어 실행.
- 예제 주제: “AI에서 강화 학습의 중요성” → 계획 수립 → 요약 생성.

---

## 6.6 Planning의 설계 기준

- **Planning 필요 시**:  
  - 복잡·다단계·종속성 많은 작업.  
  - 방법이 미리 정해지지 않은 동적 환경.  
  - 연구 보고서, 온보딩, 경쟁 분석 등.
- **고정 워크플로 선호 시**:  
  - 반복·예측 가능·잘 정의된 프로세스.  
  - 자율성보다 일관성·신뢰성 우선.
- **질문으로 판단**: “방법을 이미 아는가? vs 스스로 발견해야 하는가?”

---

## 6.7 한눈에 보기

- **무엇**: 복잡 목표를 **자율적·적응적 단계 계획**으로 변환하는 패턴.
- **왜**: 반응형 에이전트로는 다면적 요청 처리 불가 → 전략적 실행자 필요.
- **어떻게**:  
  - 목표 → 단계 분해 → 실행 + 모니터링 + 재계획.  
  - CrewAI: Planner Agent + Task.  
  - DeepResearch: 반복 검색·분석 루프.
- **언제**: 연구·온보딩·경쟁 분석 등 **상호의존 작업 순서가 핵심**일 때.

---

## 6.8 핵심 정리

- Planning은 **반응형 → 목표 지향적 에이전트**로의 도약을 가능케 하는 패턴이다.
- LLM의 강점(학습 데이터 기반 계획 생성)을 활용해 복잡 워크플로 자동화.
- DeepResearch 같은 고급 사례는 Planning + Tool Use + Reflection 결합으로 강력함을 보여준다.

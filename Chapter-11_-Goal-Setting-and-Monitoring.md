# 11장. Goal-Setting and Monitoring(목표 설정 및 모니터링)

## 11.1 패턴 개요

- **정의**: 에이전트가 **명확한 목표 설정 + 진행 추적·평가**를 통해 자율적으로 복잡 작업 달성하는 패턴이다.
- **왜 필요?** 단순 정보 처리 한계 → **목적 지향성** 부여(초기 상태 → 목표 상태).
- **비유**: 여행 계획(목적지 결정 → 경로 계획 → 진행 모니터링).

### 핵심 원리

- **목표**: SMART(구체적·측정 가능·달성 가능·관련·시간 제한).
- **모니터링**: 상태·행동·환경 관찰 → 피드백 루프 → 재계획.
- **효과**: 반응형 → 선제적 에이전트 전환.

---

## 11.2 응용 사례

| 도메인 | 목표 예시 | 모니터링 지표 |
|--------|-----------|---------------|
| **고객 지원** | 청구 문의 해결 | 피드백·변경 확인 |
| **학습 시스템** | 학습 능력 향상 | 정확도·완료 시간 |
| **프로젝트 관리** | 마일스톤 완료 | 작업 상태·지연 |
| **트레이딩 봇** | 포트폴리오 이익 극대화 | 시장 데이터·위험 |
| **자율주행** | 안전 도착 | 환경·차량 상태 |
| **콘텐츠 검토** | 유해 콘텐츠 제거 | 분류 정확도 |

---

## 11.3 구현: LangChain + OpenAI 예제

- **자율 코딩 에이전트**: 사용 사례 → 코드 생성 → 자체 평가 → 개선 반복.
- **루프**:  
  1. 프롬프트 생성(사례·목표·이전 코드·피드백).  
  2. 코드 생성(GPT-4o).  
  3. 피드백 생성(목표 준수 평가).  
  4. `goals_met()`: LLM "참/거짓" 판단 → 목표 달성 시 중단.  
  5. 최종 코드 저장(주석·파일명 자동).

### 핵심 함수

```python
def run_code_agent(use_case: str, goals_input: str, max_iters=5) -> str:
    goals = [g.strip() for g in goals_input.split(",")]
    previous_code = ""
    for i in range(max_iters):
        prompt = generate_prompt(use_case, goals, previous_code)
        code = llm.invoke(prompt).content  # 코드 생성
        feedback = get_code_feedback(code, goals)
        if goals_met(feedback.content, goals): break
        previous_code = code
    return save_code_to_file(code, use_case)
```

- **예제 입력**: "BinaryGap 찾기", 목표: "간단·정확·예외 처리·테스트 출력".

---

## 11.4 고급 고려사항

### 11.4.1 LLM 한계 보완

- **환각·오판**: 별도 평가자 LLM 사용(코드 작성 ≠ 검토).
- **객관성**: 다중 에이전트 팀(프로그래머·검토자·테스터).
- **실행 검증**: 생성 코드 실제 테스트(단위 테스트 자동).


### 11.4.2 다중 에이전트 확장

- **팀 구성**: 피어 프로그래머·코드 검토자·문서 작성자·테스트 작성자.
- **프롬프트 예**: 검토자 "오류 식별·리팩토링 제안·전후 비교".

---

## 11.5 Google ADK 통합

- **목표 전달**: 에이전트 지침(instruction).
- **모니터링**: 상태 관리(state) + 도구 상호작용 추적.
- **피드백**: 이벤트 기록 → 재계획 트리거.

---

## 11.6 한눈에 보기

- **무엇**: **목표 지향 + 자기 평가 루프**로 자율 작업 달성.
- **왜**: 방향성·성공 판단 없어 복잡 작업 실패 → 패턴으로 안정성 확보.
- **어떻게**: SMART 목표 + 모니터링(피드백 → 재계획), LangChain 반복 구현.
- **언제**: 다단계·동적 환경(지원·학습·트레이딩 등).

---

## 11.7 핵심 정리

- 목표 설정·모니터링은 **에이전트의 자율성과 안정성 기반**이다.
- 반복 루프(생성→평가→개선) + SMART + 다중 에이전트로 실현.
- 이전 패턴(계획·메모리·학습)과 결합 시 완전체 에이전트.

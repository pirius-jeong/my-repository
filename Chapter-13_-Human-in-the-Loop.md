# 13장. Human-in-the-Loop(HITL, 인간 참여)

## 13.1 HITL 패턴 개요

- **정의**: **인간 감독·피드백·개입**을 AI 워크플로에 통합해 정확성·안전성·윤리 보장하는 패턴이다.
- **왜 필요?** AI 한계(환각·모호성·위험): 완전 자율 → 재앙 → **인간-AI 시너지**로 보완.
- **원칙**: AI 자동화 + 인간 판단 = 최적 결과.

### 핵심 측면

| 측면 | 설명 | 예시 |
|------|------|------|
| **감독** | 성능 모니터링 | 로그·대시보드 검토 |
| **개입·수정** | 오류 시 인간 안내 | 데이터 보완·수정 |
| **피드백 학습** | 모델 개선 | RLHF(인간 선호도) |
| **의사결정 증강** | AI 권고 + 인간 결정 | 분석 제시 |
| **협업** | 상호 강점 활용 | AI 데이터 처리 + 인간 창의 |
| **에스컬레이션** | 역량 초과 시 인계 | 정책 기반 |

---

## 13.2 장단점

| 장점 | 단점 |
|------|------|
| 안전·윤리 보장 | 확장성 부족(인간 한계) |
| 지속 개선(RLHF) | 전문가 의존·교육 필요 |
| 모호성 처리 | 개인정보 보호 복잡 |

---

## 13.3 실제 응용 사례

| 도메인 | HITL 역할 |
|--------|-----------|
| **콘텐츠 검토** | 모호 사례 인간 최종 결정 |
| **자율주행** | 위험 상황 인간 제어 인계 |
| **금융 사기** | 고위험 경고 인간 조사 |
| **법률 검토** | AI 식별 → 인간 맥락 검증 |
| **고객 지원** | 복잡·감정 문의 인계 |
| **데이터 라벨링** | 인간 주석으로 모델 학습 |
| **생성 AI** | 콘텐츠 검토·다듬기 |
| **네트워크 관리** | 고위험 경고 인간 결정 |

### 인간 주도형 변형

- **정책 설정**: 인간 고수준 규칙 → AI 즉시 실행(금융 거래·콜센터).

---

## 13.4 구현: Google ADK 예제

- **기술 지원 에이전트**: troubleshoot → ticket → escalate_to_human.
```python
tech_support = Agent(
    instruction="기술 문제: troubleshoot → 지속 시 create_ticket → 복잡 시 escalate_to_human",
    tools=[troubleshoot_issue, create_ticket, escalate_to_human]
)

def personalize_callback(...):  # 상태 기반 개인화
    customer_info = callback_context.state.get("customer_info")
    # 시스템 메시지로 고객 데이터 삽입
```

- **개인화 콜백**: 상태(customer_info) → 프롬프트 동적 강화.

---

## 13.5 한눈에 보기

- **무엇**: **인간-AI 협업**으로 AI 한계 보완.
- **왜**: 안전·윤리·정확성 → 완전 자율 위험.
- **어떻게**: 감독·피드백·에스컬레이션, ADK 도구·콜백 구현.
- **언제**: 고위험·모호 도메인(금융·의료·법률).

---

## 13.6 핵심 정리

- HITL은 **책임 있는 AI 배포의 초석**이다.
- 자동화 확장성 + 인간 정확성 = 최적 균형.
- 에스컬레이션 정책 + 피드백 루프로 지속 개선.
